<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Color Switch Game</title>
    <style>
        canvas {
            border: 1px solid black;
            display: block;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="400" height="600"></canvas>

    <script>
        var canvas = document.getElementById("gameCanvas");
        var ctx = canvas.getContext("2d");

        var ball = {
            x: canvas.width / 2,
            y: canvas.height / 2,
            radius: 10,
            velocityY: -5,
            color: "#FF0000" // Initial color
        };

        var obstacles = [];
        var obstacleSpeed = 2;
        var obstacleTypes = ["#00FF00", "#0000FF", "#FFFF00"]; // Colors of obstacles

        function drawBall() {
            ctx.beginPath();
            ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
            ctx.fillStyle = ball.color;
            ctx.fill();
            ctx.closePath();
        }

        function drawObstacles() {
            for (var i = 0; i < obstacles.length; i++) {
                var obstacle = obstacles[i];
                ctx.beginPath();
                ctx.arc(obstacle.x, obstacle.y, obstacle.radius, 0, Math.PI * 2);
                ctx.fillStyle = obstacle.color;
                ctx.fill();
                ctx.closePath();
            }
        }

        function updateBall() {
            ball.y += ball.velocityY;

            if (ball.y + ball.radius < 0 || ball.y + ball.radius > canvas.height) {
                gameOver();
            }
        }

        function updateObstacles() {
            for (var i = 0; i < obstacles.length; i++) {
                obstacles[i].y += obstacleSpeed;

                if (obstacles[i].y > canvas.height + obstacles[i].radius) {
                    obstacles.splice(i, 1); // Remove obstacles that are out of the canvas
                }
            }

            if (Math.random() < 0.01) { // Add new obstacle occasionally
                var randomX = Math.random() * canvas.width;
                var randomType = obstacleTypes[Math.floor(Math.random() * obstacleTypes.length)];
                obstacles.push({ x: randomX, y: -30, radius: 15, color: randomType });
            }
        }

        function checkCollision() {
            for (var i = 0; i < obstacles.length; i++) {
                var dy = ball.y - obstacles[i].y;
                var distance = Math.sqrt(dy * dy);

                if (distance < ball.radius + obstacles[i].radius) {
                    if (ball.color === obstacles[i].color) {
                        // Pass through obstacle of the same color
                        obstacles.splice(i, 1);
                    } else {
                        gameOver();
                    }
                }
            }
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            drawBall();
            drawObstacles();

            updateBall();
            updateObstacles();
            checkCollision();

            requestAnimationFrame(draw);
        }

        function gameOver() {
            alert("Game Over!");
            location.reload(); // Reload the page to restart the game
        }

        document.addEventListener("keydown", function(event) {
            if (event.keyCode === 32) { // Spacebar to change ball color
                var currentIndex = obstacleTypes.indexOf(ball.color);
                var newIndex = (currentIndex + 1) % obstacleTypes.length;
                ball.color = obstacleTypes[newIndex];
            }
        });

        draw();
    </script>
</body>
</html>
